@using TextEdit.Core.Documents
@using TextEdit.Core.Editing
@using TextEdit.UI.Components.Editor

<main class="editor h-full min-h-0 flex flex-col" 
      role="tabpanel" 
      id="editor-panel"
      aria-labelledby="@(AppState.ActiveTab != null ? $"tab-{AppState.ActiveTab.Id}" : "")"
        style="height:100%;min-height:0;display:flex;flex-direction:column;flex:1 1 auto; position:relative;">
    <textarea id="main-editor-textarea"
              class="editor-textarea flex-1 min-h-0 w-full p-2 font-mono resize-none"
              role="textbox"
              aria-label="Text editor content"
              aria-multiline="true"
                    style="height:100%;min-height:0;flex:1 1 auto;box-sizing:border-box;border:none;outline:1px solid var(--border);border-radius:6px;padding-right:12px;padding-bottom:12px;caret-color:var(--fg);line-height:1.4;white-space:@(State.WordWrap ? "pre-wrap" : "pre");overflow-wrap:@(State.WordWrap ? "break-word" : "normal");"
              @ref="textareaElement"
              @bind="Content"
              @bind:event="oninput"
              @onfocus="UpdateCaretPosition"
              @onmouseup="UpdateCaretPosition"
              @onkeyup="UpdateCaretPosition"
              @onblur="OnBlur"></textarea>      <FindBar 
        @ref="_findBar"
        IsVisible="@_showFind"
        Text="@Content"
      OnClose="@OnFindClosed"
        EditorElementId="main-editor-textarea" />

      <ReplaceBar
        @ref="_replaceBar"
        IsVisible="@_showReplace"
        MatchCase="@_replaceMatchCase"
        MatchCaseChanged="@(v => { _replaceMatchCase = v; StateHasChanged(); })"
        WholeWord="@_replaceWholeWord"
        WholeWordChanged="@(v => { _replaceWholeWord = v; StateHasChanged(); })"
        OnReplaceNext="@OnReplaceNextRequested"
        OnReplaceAll="@OnReplaceAllRequested"
        OnClose="@OnReplaceClosed" />
</main>
